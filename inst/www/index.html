<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>Test pica</title>
  
   <!-- Include order: first jquery, then opencpu.js, and then your code -->
    <script src="//code.jquery.com/jquery-1.10.2.min.js"></script> 
    <script src="//www.opencpu.org/js/archive/opencpu-0.4.js"></script>
    <script>
      $(document).ready(function(){        
        var mysession;
        ocpu.seturl("../R");
      $("#valeursubmit").on("click", function(){
        //disable the button to prevent multiple clicks
        $("#valeursubmit").attr("disabled", "disabled");
        
        //perform the request
        var req1 = ocpu.call("importMathDist", {parcelle : "larzat"}, function(session){
          mysession = session;
          console.log(mysession);
          $("#output").text(mysession.getLoc());
          var req = ocpu.call("Calcul_fourmis_distance", {
          dist_mat : mysession
        }, function(session){
          session.getObject(function(data){
            console.log(data);
          });
        }).fail(function(){
          alert(req.responseText);
        });
        });
        
        
        
        
        //if R returns an error, alert the error message
        req.fail(function(){
          alert("Server error: " + req.responseText);
        });
        
        //after request complete, re-enable the button 
        req.always(function(){
          $("#valeursubmit").removeAttr("disabled")
        });
      });
    });
    </script>

  </head>

  <body>
    <form>
      <b>Guilhem, donne-moi un nombre : </b> <input type="number" id="namefield" value="0">
      <button type="submit" id="valeursubmit" class="btn btn-default">Soumettre</button>
   </form>
  <p id="output"></p>
</body>

</html>
